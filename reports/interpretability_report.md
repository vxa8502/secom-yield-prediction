# Interpretability Analysis Report
## SECOM Semiconductor Defect Prediction

**Model:** SVM with lasso features
**Threshold:** 0.540
**Test G-Mean:** 0.7218

---

## Misclassification Analysis

### False Negative Summary (Missed Defects)

|   rank |   test_index |   true_label |   predicted_label |   predicted_proba | error_type     |   distance_to_threshold |
|-------:|-------------:|-------------:|------------------:|------------------:|:---------------|------------------------:|
|      1 |          241 |            1 |                 0 |          0.198001 | false_negative |               0.341999  |
|      2 |           73 |            1 |                 0 |          0.315312 | false_negative |               0.224688  |
|      3 |          283 |            1 |                 0 |          0.322128 | false_negative |               0.217872  |
|      4 |          187 |            1 |                 0 |          0.401742 | false_negative |               0.138258  |
|      5 |          239 |            1 |                 0 |          0.446438 | false_negative |               0.0935624 |

**Key Observations:**
- 7 total false negatives (missed defects out of 21 actual failures)
- Top 5 analyzed with SHAP waterfall plots (closest to threshold)
- Waterfall plots saved to `reports/figures/misclassification/`
- See individual plots for feature-level attribution of each missed defect

---

## Residual Distribution Analysis

| Metric | Overall | Passes | Failures |
|--------|---------|--------|----------|
| Mean | -0.3438 | -0.3973 | 0.4018 |
| Std | 0.2674 | 0.1787 | 0.1665 |
| N | 314 | 293 | 21 |

**Calibration Assessment:**
- Pass predictions: underconfident
- Fail predictions: underconfident

**Interpretation:**
- Skewness: 1.1899 (0 = symmetric)
- Kurtosis: 3.2421 (0 = normal tails)

---

## Performance by Missingness

| quartile   |   n_samples |   n_failures |   fail_rate |   mean_missing_pct |    gmean |   sensitivity |   specificity |   mean_proba |
|:-----------|------------:|-------------:|------------:|-------------------:|---------:|--------------:|--------------:|-------------:|
| Q1 (low)   |          79 |            6 |   0.0759494 |            2.28063 | 0.708719 |      0.666667 |      0.753425 |     0.427983 |
| Q2         |          94 |            4 |   0.0425532 |            3.77209 | 0.632456 |      0.5      |      0.8      |     0.39929  |
| Q3         |          69 |            4 |   0.057971  |            4.97666 | 0.638508 |      0.5      |      0.815385 |     0.39187  |
| Q4 (high)  |          72 |            7 |   0.0972222 |            7.55179 | 0.803837 |      0.857143 |      0.753846 |     0.424796 |

**Interpretation:**
- Check if G-Mean varies significantly across missingness quartiles
- Large drops in Q4 (high missingness) may indicate data quality issues affecting predictions

---

## False Negative Cluster Analysis

|   cluster |   n_samples |   mean_proba | distinctive_features                                         |
|----------:|------------:|-------------:|:-------------------------------------------------------------|
|         0 |           1 |     0.53044  | feature_59 (+1.21), feature_64 (+1.04), feature_510 (-0.79)  |
|         1 |           5 |     0.403818 | feature_129 (+0.71), feature_64 (-0.70), feature_103 (-0.31) |
|         2 |           1 |     0.198001 | feature_129 (-1.79), feature_103 (-1.00), feature_64 (-0.54) |

**Interpretation:**
- Clusters reveal systematic patterns in missed defects
- Distinctive features show how each cluster differs from the overall test population
- Consider targeted feature engineering or threshold adjustment for underperforming clusters

---

## Recommendations

1. **For missed defects with low predicted probability:** These represent confident mistakes. Review SHAP waterfalls to understand which features mislead the model.

2. **For calibration issues:** If predictions are overconfident/underconfident, consider Platt scaling or isotonic regression.

3. **For missingness-related performance drops:** Consider missingness indicators as features or separate models for high-missingness samples.

4. **For clustered failure modes:** Each cluster may represent a distinct failure mechanism. Domain experts should validate if these correspond to known process issues.

---

*Generated by pipelines/analyze.py*
